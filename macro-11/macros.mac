	.NLIST
;
;  Define some macros.
;
	.SBTTL Macros - Macro definitions
;
;  These are macros for the various textio routines
;
	.SBTTL TEXTIO - Macros for console input and output
.MACRO	put msg, len
	MOV len, -(SP)
	MOV msg, -(SP)
	JSR PC, put
	ADD #4, SP
.ENDM	put

.MACRO	puts text
	MOV text, -(SP)
	JSR PC, puts
	ADD #2, SP
.ENDM	puts

.MACRO	gets str
	MOV str, -(SP)
	JSR PC, gets
	ADD #2, SP
.ENDM	gets

.MACRO	putsln text
	MOV text, -(SP)
	JSR PC, putsln
	ADD #2, SP
.ENDM	putsln

.MACRO	putln msg, len
	MOV len, -(SP)
	MOV msg, -(SP)
	JSR PC, putln
	ADD #4, SP
.ENDM	putln

.MACRO	putoct num
        MOV num, -(SP)
        JSR PC, putoct
        ADD #2, SP
.ENDM	putoct

.MACRO	putdec num
	MOV num, -(SP)
	JSR PC, putdec
	ADD #2, SP
.ENDM	putdec

.MACRO	puthex num
	MOV num, -(SP)
	JSR PC, puthex
	ADD #2, SP
.ENDM	puthex

	.SBTTL STRING - Macros for string functions.
;
;  Macros for strings.  A string is a block of up to 255 bytes
;  of memory with a max length and current length attached.
;
;  The string macro allocates space for a string and sets it to
;  an empty string.
;
.MACRO	string lbl, max
	.SAVE
	.PSECT STRING,GBL
lbl:	.BYTE max
	.BYTE 0
	.BLKB max
	.RESTORE
.ENDM	string
;
;  The text macro is used to define a fixed text message.
;
.MACRO	text lbl, txt
	.SAVE
	.PSECT TEXT, GBL
	.NCHR $1, <txt>
lbl:	.BYTE $1
	.BYTE $1
	.ASCII /txt/
	.RESTORE
.ENDM	text
;
;  Trim whitespace characters from the end of a string.
;
.MACRO	trimts str
	MOV str, -(SP)
	JSR PC, trimts
	ADD #2, SP
.ENDM	trimts
;
;  Generalized trim macro selects which trims to call
;
.MACRO	trim str,ls,ts,lz,tz
	MOV str, -(SP)
.IF	NB ls
	JSR PC, trimls
.ENDC
.IF	NB ts
	JSR PC, trimts
.ENDC
.IF	NB lz
	JSR PC, trimlz
.ENDC
.IF	NB tz
	JSR PC, trimtz
.ENDC
	ADD #2, SP
.ENDM	trim
;
;  Get the length and max length of a string
;
.MACRO	strlen str, len
	MOV str, -(SP)
	JSR PC, strlen
	MOV (SP)+, len
.ENDM	strlen

.MACRO	strmax str, max
	MOV str, -(SP)
	JSR PC, strmax
	MOV (SP)+, max
.ENDM	strmax
;
;  Extract a character from a string
;
.MACRO	strchr str, pos, chr
	MOV str, -(SP)
	MOV pos, -(SP)
	JSR PC, strchr
	MOV (SP)+, chr
	ADD #2, SP
.ENDM	strchr
;
;  Convert a character to a string
;
.MACRO	chrstr str, chr
	MOV str, -(SP)
	MOV chr, -(SP)
	JSR PC, chrstr
	ADD #4, SP
.ENDM	chrstr
;
;  Find a character in a string
;
.MACRO	sfindc str, chr, pos
	MOV str, -(SP)
	MOV chr, -(SP)
	JSR PC, sfindc
	MOV (SP)+, pos
	ADD #2, SP
.ENDM	sfindc
;
;  Convert unsigned integers to strings in octal, decimal,
;  and hexidecimal
;
.MACRO	octstr str, num
	MOV str, -(SP)
	MOV num, -(SP)
	JSR PC, octstr
	ADD #4, SP
.ENDM	octstr

.MACRO	decstr str, num
	MOV str, -(SP)
	MOV num, -(SP)
	JSR PC, decstr
	ADD #4, SP
.ENDM	decstr

.MACRO hexstr str, num
	MOV str, -(SP)
	MOV num, -(SP)
	JSR PC, hexstr
	ADD #4, SP
.ENDM	hexstr
;
;  Convert strings containing numbers to unsigned
;  integers in octal, decimal, and hexidecimal
;
.MACRO	stroct str, num
	MOV str, -(SP)
	JSR PC, stroct
	MOV (SP)+, num
.ENDM	stroct

.MACRO	strdec str, num
	MOV str, -(SP)
	JSR PC, strdec
	MOV (SP)+, num
.ENDM	strdec

.MACRO	strhex str, num
	MOV str, -(SP)
	JSR PC, strhex
	MOV (SP)+, num
.ENDM	strhex
;
;  Extract a substring from a string.
;
.MACRO	substr src, dest, start, count
	MOV src, -(SP)
	MOV dest, -(SP)
	MOV start, -(SP)
	MOV count, -(SP)
	JSR PC, substr
	ADD #8., SP
.ENDM	substr
;
;  Other string manipulation
;
.MACRO	cpstr src, dest
	MOV src, -(SP)
	MOV dest, -(SP)
	JSR PC, cpstr
	ADD #4, SP
.ENDM	cpstr

.MACRO	appstr src, dest
	MOV src, -(SP)
	MOV dest, -(SP)
	JSR PC, appstr
	ADD #4, SP
.ENDM	appstr
;
;  Convert strings to upper or lower case
;
.MACRO	upcase str
	MOV str, -(SP)
	JSR PC, upcase
	ADD #2, SP
.ENDM	upcase

.MACRO	locase str
	MOV str, -(SP)
	JSR PC, locase
	ADD #2, SP
.ENDM	locase
;
;  Compare strings for equality
;
.MACRO	streq str1, str2
	MOV str1, -(SP)
	MOV str2, -(SP)
	JSR PC, streq
	ADD #2, SP
	TST (SP)+
.ENDM	streq
	.LIST
